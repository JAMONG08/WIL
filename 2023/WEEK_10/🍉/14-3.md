# 14-3 페이지 교체

### 프레임할당- 요구페이징

- 요구하는 페이지만 적재
- CPU 접근 요청 > 유효비트가 있으면 메모리있고 없음 말고 > 유효비트가 0인 경우 =페이지 폴트시 메모리 적재 후 실행
- 웹 프레임워크들에서는 lazy loading 개념이라고 보면 된다.

### 페이지 교체 알고리즘

- 메모리에 페이지 공간이 꽉 차면 페이지 교체 필요(스왑 인아웃)
- 페이지 참조열(page reference string) : 연속된 참조 부분은 제외

- 종류
    - FIFO(First In First Out) : 처음 메모리에 올라온 페이지를 스왑 영역으로 보낸다.
        
        ![image.png](14-3image.png)
        
    - 기회(Second Chance) 페이지 교체 알고리즘: FIFO를 기본 + 참조비트(0,1) 추가
        - 0이면 바로 아웃, 1이면 0으로 만들고 기회를 줌 기회를 한 번 더 준다.
    - 최적(Optimal) 페이지 교체 : 가장 오랫동안 사용하지 않을 페이지 스왑 아웃
        
        ![image.png](14-3image%201.png)
        
        - 페이지 폴트 줄일 수 있으나 예측 어려움
        - 다른 알고리즘들의 상대적인 성능을 평가하는데 사용(이론적 알고리즘)
    - LRU(Least Recently Used) : 가장 오랫동안 사용하지 않은 페이지 스왑 아웃
        
        ![image.png](14-3image%202.png)
        
    - LFU(Latest Frequently Used) ****: 사용빈도가 적은 페이지를 스왑 아웃
    

### 스레싱(Thrashing)과 페이지 교체

- 스레싱 : 페이지 교체 시간 > 실행시간
    - Page Fault가 연속적으로 발생하여 프로세스 수행시간보다 페이지 교체 시간이 많은 상태
    = 메모리에 페이지 부재율이 높은 것.
    - 지나치게 빈번한 페이지 교체로 인해 CPU 성능이 낮아짐
    - 다중 프로그래밍 높아짐 따라 이용률 향상, 임계치 도달 후 낮아짐

![image.png](14-3image%203.png)

### 원인 발생과정

![image.png](14-3image%204.png)

### 페이지 할당 방식

- 정적할당 (프로세스의 물리적 크기에 기반)
    - 균등할당 : 각 프로세스에게 동일한 프레임 수를 할당
    - 비례할당 : 각 프로세스에게 프레임 수를 프로세스 크기에 비례하여 할당
- 동적할당
    - 작업 집합 모델(workset model) : 특정 시간동안 주로 참조한 페이지 개수만큼만을 프레임 할당
        - 과거 데이터 기반으로 앞으로 얼마나쓸지 미래 예측하는 방식을 사용
        - 지역성의 원리를 이용하여 지역성 집합이 메모리에 동시에 올라갈 수 있도록 보장
        
        ![image.png](14-3image%205.png)
        
    - 페이지 폴트 빈도 모델(page fault frequency model, PFF) : 페이지 폴트가 발생한 횟수를 기준으로 프레임을 할당
        - 프레임 할당 높이면 > 페이지 결함 줄어듦
        - 프레임 할당 낮으면 > 페이지 결함 많아짐
        - 페이지 부재율을 주기적으로 조사하고 이 값에 근거하여 각 프로세스에 할당할 메모리 양을 동적으로 예측하고 조절하는 알고리즘 = 메모리에 올라가있는 프로세스의 수를 조절
            
            ![image.png](14-3image%206.png)
            
        
    

![Untitled](14-3Untitled.png)